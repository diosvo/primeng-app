<p-table #dt dataKey="id" [value]="customers" [resizableColumns]="true" [responsive]="true" [autoLayout]="true"
    [paginator]="true" [rows]="10" [rowsPerPageOptions]="[10,25,50]" [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" sortField="date" [sortOrder]="-1"
    styleClass="p-datatable-customers" [globalFilterFields]="['name','country.name','representative.name','status']">

    <ng-template pTemplate="caption">
        <div>
            <div class="table-header p-d-flex p-ai-center p-text-uppercase p-text-center">
                List of Customers
                <!-- <span class="p-input-icon-left p-ml-auto">
                    <i class="pi pi-search"></i>
                    <input pInputText style="font-size: 14px;" type="text" placeholder="Global search..." />
                </span> -->
            </div>
        </div>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="name">
                <div class="p-d-flex p-jc-between p-ai-center">
                    Name
                    <p-sortIcon field="name"></p-sortIcon>
                    <p-columnFilter class="p-ml-auto" type="text" field="name" display="menu"></p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="country.name">
                <div class="p-d-flex p-jc-between p-ai-center">
                    Country
                    <p-sortIcon field="country.name"></p-sortIcon>
                    <p-columnFilter matchMode="contains" class="p-ml-auto" type="text" field="country.name"
                        display="menu"></p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="representative.name">
                <div class="p-d-flex p-jc-between p-ai-center">
                    Agent
                    <p-sortIcon field="representative.name"></p-sortIcon>
                    <p-columnFilter matchMode="contains" class="p-ml-auto" type="text" field="representative.name"
                        display="menu">
                    </p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="date">
                <div class="p-d-flex p-jc-between p-ai-center">
                    Date
                    <p-sortIcon field="date"></p-sortIcon>
                    <p-columnFilter class="p-ml-auto" type="date" field="date" display="menu"></p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="status" matchMode="equals">
                <div class="p-d-flex p-jc-between p-ai-center">
                    Status
                    <p-sortIcon field="status"></p-sortIcon>
                    <p-columnFilter field="status" class="p-ml-auto" matchMode="equals" display="menu">
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-dropdown [ngModel]="value" [options]="statuses" (onChange)="filter($event.value)"
                                placeholder="Select Status">
                                <ng-template let-option pTemplate="item">
                                    <span
                                        [class]="'p-py-1 p-px-2 p-text-bold p-text-uppercase  customer-badge status-' + option.value">{{option.label}}</span>
                                </ng-template>
                            </p-dropdown>
                        </ng-template>
                    </p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="activity">
                Activity
                <p-sortIcon field="status"></p-sortIcon>
            </th>
            <th></th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-customer>
        <tr>
            <td>{{customer.name}}</td>
            <td>
                <img src="../../../assets/flag_placeholder.png" [class]="'flag flag-' + customer.country.code"
                    width="30">
                <span class="p-ml-2">{{customer.country.name}}</span>
            </td>
            <td class="p-d-flex p-ai-center">
                <p-avatar icon="pi pi-user" styleClass="p-mr-2" shape="circle"></p-avatar>
                {{customer.representative.name}}
            </td>
            <td>{{customer.date | date: 'MM/dd/yyyy'}}</td>
            <td class="" [ngSwitch]="customer.status">
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-unqualified"
                    *ngSwitchCase="'unqualified'">{{customer.status}}</span>
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-qualified"
                    *ngSwitchCase="'qualified'">{{customer.status}}</span>
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-new"
                    *ngSwitchCase="'new'">{{customer.status}}</span>
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-negotiation"
                    *ngSwitchCase="'negotiation'">{{customer.status}}</span>
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-renewal"
                    *ngSwitchCase="'renewal'">{{customer.status}}</span>
                <span class="p-py-1 p-px-2 p-text-bold p-text-uppercase customer-badge status-proposal"
                    *ngSwitchCase="'proposal'">{{customer.status}}</span>
            </td>
            <td>
                <p-progressBar [value]="customer.activity" [showValue]="false"></p-progressBar>
            </td>
            <td class="p-text-center"><button class="p-button-sm p-button-outlined p-button-rounded p-button-secondary"
                    pButton type="button" icon="pi pi-cog" iconPos="left"></button></td>
        </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
        <tr>
            <td class="p-text-center" [attr.colspan]="customers.length">No customers found.</td>
        </tr>
    </ng-template>
</p-table>